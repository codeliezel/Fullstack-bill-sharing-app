{"version":3,"sources":["../../src/utils/jwt.js"],"names":["secretKey","process","env","SECRET","Jwt","payload","secret","jwt","sign","expiresIn","token","verify","decoded"],"mappings":";;;;;;;;;;;;;;;;;AAAA;;AACA;;AACA;;AAEA;AAEA,IAAMA,SAAS,GAAGC,OAAO,CAACC,GAAR,CAAYC,MAA9B;AAEA;AACA;AACA;AACA;AACA;;IACqBC,G;;;;;;;;AACnB;AACF;AACA;AACA;AACA;AACA;AACA;;yGACE,iBAA2BC,OAA3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAoCC,gBAAAA,MAApC,2DAA6CN,SAA7C;AAAA;AAAA,uBACsBO,yBAAIC,IAAJ,CAASH,OAAT,EAAkBC,MAAlB,EAA0B;AAAEG,kBAAAA,SAAS,EAAE;AAAb,iBAA1B,CADtB;;AAAA;AACQC,gBAAAA,KADR;AAAA,iDAESA,KAFT;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,O;;;;;;;;AAKA;AACF;AACA;AACA;AACA;AACA;AACA;;;;;uGACE,kBAAyBA,KAAzB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAgCJ,gBAAAA,MAAhC,8DAAyCN,SAAzC;AAAA;AAAA,uBACwBO,yBAAII,MAAJ,CAAWD,KAAX,EAAkBJ,MAAlB,CADxB;;AAAA;AACQM,gBAAAA,OADR;AAAA,kDAESA,OAFT;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,O","sourcesContent":["import { config } from 'dotenv';\nimport jwt from 'jsonwebtoken';\nimport 'dotenv/config';\n\nconfig();\n\nconst secretKey = process.env.SECRET;\n\n/**\n * @class Jwt\n * @description class for token generation and verification\n * @exports Jwt\n */\nexport default class Jwt {\n  /**\n   * @method generateToken\n   * @description Method to generate new token\n   * @param {object} payload - The data used to generate the token\n   * @param {string} secret - The secret key used to generate the token\n   * @returns {string} the generated token\n   */\n  static async generateToken(payload, secret = secretKey) {\n    const token = await jwt.sign(payload, secret, { expiresIn: '1d' });\n    return token;\n  }\n\n  /**\n   * @method verifyToken\n   * @description Method to decode the token\n   * @param {string} token - The token to be verified\n   * @param {string} secret - The secret key used to generate the token\n   * @returns {object} the payload decoded from the token\n   */\n  static async verifyToken(token, secret = secretKey) {\n    const decoded = await jwt.verify(token, secret);\n    return decoded;\n  }\n}\n"],"file":"jwt.js"}